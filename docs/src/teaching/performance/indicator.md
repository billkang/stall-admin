# 前端性能优化通用指标及提升手段

## 一、前端性能优化通用指标

### （一）FP（First Paint）

FP（首次绘制）标志着浏览器开始在屏幕上渲染任何内容，包括背景颜色改变。这是用户看到页面开始加载的第一个视觉反馈。尽管 FP 是一个相对宽泛的指标，但它能快速给出页面开始加载的初步指示。优化 FP 的手段包括减少初始 CSS 和 JavaScript 的体积，优先加载关键 CSS，使用 \<link rel="preload"\> 提前加载关键资源。

### （二）FCP（First Contentful Paint）

FCP（首次内容绘制）衡量从网页开始加载到网页任何部分呈现在屏幕上所用的时间。这个指标关注的是用户看到的第一个内容，可以是文本、图片或其他媒体元素。优化 FCP 的手段包括减少关键路径的资源大小，优化图片和视频等大资源的加载，使用懒加载、图片压缩、现代格式（如 WebP）。

### （三）FMP（First Meaningful Paint）

FMP（首次有效绘制）是页面主要内容开始呈现给用户的时刻。这个指标更关注于用户感知，即用户开始看到页面上他们认为“有意义”的内容。FMP 已经被 LCP 所替代，因为 LCP 提供了更准确的度量标准。

### （四）LCP（Largest Contentful Paint）

LCP（最大内容绘制）衡量的是页面上最大的可见元素（文字块或图像）变为可见所需的时间。这是用户感知页面加载完成的重要标志，直接影响到用户感受到的速度。优化 LCP 的手段包括优化图片和视频等大资源的加载，使用懒加载、图片压缩、现代格式（如 WebP），确保关键路径资源优先加载，使用 \<link rel="preload"\> 或 \<img srcset\>。

### （五）CLS（Cumulative Layout Shift）

CLS（累计布局偏移）衡量的是页面在加载过程中元素意外移动的总量。这会导致糟糕的用户体验，比如用户点击错误的链接或阅读被打断。优化 CLS 的手段包括避免在页面加载期间修改已渲染元素的尺寸，确保所有元素尺寸提前计算好，使用 height 和 width 属性为图片和 iframe 等元素指定尺寸，动态插入内容时预留空间或使用 CSS 动画而非即时布局变化。

### （六）FID（First Input Delay）

FID（首次输入延迟）衡量从用户首次与您的网站互动（点击链接、点按按钮或使用由 JavaScript 提供支持的自定义控件）到浏览器实际能够响应该互动的时间。优化 FID 的手段包括减少 JavaScript 的阻塞，使用代码拆分和异步加载，优化服务器响应时间和网络连接，使用 HTTP/2 和 CDN。

### （七）TTI（Time to Interactive）

TTI（可交互时间）衡量的是从网页开始加载到视觉呈现、其初始脚本（若有）已加载且能够快速可靠地响应用户输入的时间。优化 TTI 的手段包括减少 JavaScript 的阻塞，使用代码拆分和异步加载，优化服务器响应时间和网络连接，使用 HTTP/2 和 CDN。

### （八）TBT（Total Blocking Time）

TBT（总阻塞时间）测量 FCP 和 TTI 之间的总时间，在此期间，主线程处于屏蔽状态的时间够长，足以阻止输入响应。优化 TBT 的手段包括减少 JavaScript 的阻塞，使用代码拆分和异步加载，优化服务器响应时间和网络连接，使用 HTTP/2 和 CDN。

### （九）INP（Interaction to Next Paint）

INP（交互到下次绘制）衡量与网页进行每次点按、点击或键盘交互的延迟时间，并根据互动次数选择该网页最差的互动延迟时间（或接近最高延迟时间）作为单个代表性值，以描述网页的整体响应速度。优化 INP 的手段包括减少 JavaScript 的阻塞，使用代码拆分和异步加载，优化服务器响应时间和网络连接，使用 HTTP/2 和 CDN。

### （十）FPS（Frames Per Second）

FPS（每秒帧率）表示的是每秒钟画面更新次数。当今大多数设备的屏幕刷新率都是 60 次/秒。帧率能够达到 50～60 FPS 的动画将会相当流畅，让人倍感舒适；帧率在 30～50 FPS 之间的动画，因各人敏感程度不同，舒适度因人而异；帧率在 30 FPS 以下的动画，让人感觉到明显的卡顿和不适感。优化 FPS 的手段包括减少 DOM 操作，避免频繁的重绘和回流，使用 CSS 动画和硬件加速。

## 二、提升手段

### （一）减少资源体积

* **清理冗余的代码、图片和视频等无效资源**：通过代码审查和工具检测，清理页面中不必要的代码和资源，减少文件大小。
* **优化代码结构**：将重复的代码提炼为公共组件、公共样式、全局变量和函数等，减少代码冗余。使用路由懒加载和大组件异步加载，减少主包的体积。
* **打包构建时，将代码和资源进行压缩**：使用打包工具（如 Webpack）的压缩功能，对代码和资源进行压缩，减少文件大小。

### （二）减少访问服务器的次数

* **合并代码，减少代码文件数量**：将多个小文件合并为一个文件，减少 HTTP 请求次数。
* **使用 SSR 服务器渲染**：将网页和数据一起加载，一起渲染，减少页面加载时间。

### （三）优化资源加载

* **优化图片加载**：使用现代图片格式（如 WebP），对图片进行压缩，使用懒加载技术，减少图片加载时间。
* **使用 CDN**：利用内容分发网络（CDN）将资源分发到离用户最近的服务器，减少传输延迟。
* **使用浏览器缓存**：合理设置缓存策略，利用浏览器缓存减少重复资源的加载。

### （四）优化代码执行

* **减少 JavaScript 的阻塞**：使用代码拆分和异步加载，减少 JavaScript 的阻塞，提高页面响应速度。
* **使用 Web Workers**：将耗时的计算任务移到工作线程，避免阻塞主线程，提升页面响应速度。
* **优化 CSS 动画**：避免使用复杂的 CSS 动画，尽量使用简单的动画效果，减少重绘和回流。

### （五）优化页面渲染

* **减少 DOM 操作**：尽量减少对 DOM 元素的访问和操作，可以使用文档片段（DocumentFragment）或虚拟 DOM 减少重绘和回流。
* **使用骨架屏或占位符元素**：在页面内容加载完成之前，显示骨架屏或占位符元素，提高用户体验。

## 三、业内比较好的数值

### （一）LCP（最大内容绘制）

* **目标值**：LCP 应该尽快发生，理想情况下在 2.5 秒内。

### （二）CLS（累计布局偏移）

* **目标值**：CLS 的目标值是小于 0.1，意味着布局偏移较小，用户体验较好。

### （三）FID（首次输入延迟）

* **目标值**：FID 的目标值是小于 100 毫秒，确保用户在点击或交互时能够得到快速响应。

### （四）TTI（可交互时间）

* **目标值**：TTI 的目标值是小于 10 秒，确保页面在合理的时间内可以交互。

### （五）TBT（总阻塞时间）

* **目标值**：TBT 的目标值是小于 300 毫秒，确保页面在加载过程中不会长时间阻塞。

### （六）INP（交互到下次绘制）

* **目标值**：INP 的目标值是小于 200 毫秒，确保用户在交互时能够得到快速响应。

### （七）FPS（每秒帧率）

* **目标值**：FPS 的目标值是达到 50～60 FPS，确保动画流畅，用户体验良好。

## 四、总结

前端性能优化是提升用户体验和网站竞争力的重要手段。通过优化页面加载速度、渲染性能和交互响应速度，可以提高用户满意度和留存率。在实际项目中，可以通过减少资源大小、优化代码、使用缓存和延迟加载等方式进行性能优化。同时，利用性能优化工具进行分析和优化，可以更有效地提升前端性能。
